[["index.html", "tigeR: Tumor Immunotherapy Gene Expression Data Analysis R package  Getting start with tigeR 0.1  Introduction 0.2  The workflow of tigeR 0.3 ️ Installation 0.4 ️ Function Overview 0.5  Troubleshooting", " tigeR: Tumor Immunotherapy Gene Expression Data Analysis R package Yihao Chen, Li-Na He, Yuanzhe Zhang, Yuelong Shu, Di Zhang, Guangchuang Yu, Zhixiang Zuo 2024-05-13  Getting start with tigeR 0.1  Introduction  tigeR encompasses 4 distinct yet closely interconnected modules: The Biomarker Evaluation module enables researchers to evaluate whether the biomarkers of interest are associated with immunotherapy response via built-in or custom immunotherapy gene expression data. The Tumor Microenvironment Deconvolution module integrates 10 open-source algorithms to obtain the proportions of different cell types within the tumor microenvironment, facilitating the investigation of the association between immune cell populations and immunotherapy response. The Prediction Model Construction module equips users with the ability to construct sophisticated prediction models using a range of built-in machine learning algorithms. The Response Prediction module predict the immunotherapy response for the patients from gene expression data using our pre-trained machine learning models or public gene expression signatures. 0.2  The workflow of tigeR  As depicted in this figure, users have the flexibility to load built-in gene expression data with immunotherapy outcome information or to utilize their own data for subsequent analysis.  The Biomarker Evaluation module serves to assess the correlation between biomarkers and immunotherapy outcomes.  Furthermore, the Tumor Microenvironment Deconvolution module enables the derivation of cell type proportions within the tumor microenvironment using 10 open-source algorithms. This module also provides functionality for evaluating the interplay between fractions of tumor microenvironment cells and immunotherapy outcomes.  Subsequently, based on the features selected from these two modules, users can leverage the Prediction Model Construction module, which incorporates a range of machine learning models, to train a model for predicting immunotherapy response using transcriptome gene expression data.  Users can use the Response Prediction module to predict the immunotherapy response for the patients from gene expression data using our pre-trained machine learning models or public gene expression signatures. 0.3 ️ Installation packages &lt;- c(&quot;BiocManager&quot;, &quot;devtools&quot;, &quot;ggplot2&quot;, &quot;pROC&quot;, &quot;RobustRankAggreg&quot;) for (package in packages) { if (!require(package, character.only = TRUE)) { install.packages(package) } } devtools::install_github(&quot;YuLab-SMU/tigeR&quot;) 0.4 ️ Function Overview Data Loading Dataloader(): load data online (ExperimentHub or TIGER Web Server). Biomarkder Evaluation score_biomk(): generate a comprehensive signature score matrix for the 23 signatures in tigeR. Columns represent the signature scores, while rows denote the sample names. score_biomk_SE(): generate a comprehensive signature score matrix for the 23 signatures in tigeR. Columns represent the signature scores, while rows denote the sample names. (return a SummarizedExperiment object) roc_biomk(): generate a Receiver Operating Characteristic (ROC) object and a curve to assess the predictive performance. diff_biomk(): plot differential result (Responder vs Non-Responder or Pre-Treatment vs Post-Treatment). surv_biomk(): calculates hazard ratios, confidence intervals and P value of cox-ph analysis as well as draw KM curve. compare_biomk(): generate a heatmap of signature auc of datasets. browser_biomk(): generate an integration diagram comprising a bar plot representing AUC and a dot plot denoting Hazard Ratio and P-value. integrate_analysis(): perform differential expression analysis and survival analysis. TME Deconvolution TME_deconvolution(): perform Tumor Microenvironment deconvolution through 10 open-source algorithms. fraction_pie(): generate a pie plot illustrating the cell fraction or relative cell abundance for each sample. Prediction Model Construction data_standardization(): perform data standardization, including converting FPKM to TPM, removing NA values, applying log transformation, and scaling the data. compare_roc(): plot all the roc curves on a single plot. gini_gene(): calculating the Gini index and get an overview of the classification efficiency of genes. diff_gene(): return differential expression gene between Responder and Non-Responder. build_Model(): generate immunotherapy response prediction machine-learning model. test_Model(): test model generated by build_Model function. Response Prediction pred_response(): predict immunotherapy response and generate heatmap of signatures. 0.5  Troubleshooting Please report bugs in Github issue. "],["load-data-into-r-environment.html", "Chapter 1  Load data into R environment 1.1 Organization of built-in data 1.2 Obtain data from tigeR web server 1.3 Obtain data from ExperimentHub 1.4 Pre-processing of Custom Data", " Chapter 1  Load data into R environment 1.1 Organization of built-in data The built-in data follows several specifications for constructing: ① They are constructed into a SummarizedExperiment object using the SummarizedExperiment() function in SummarizedExperiment package. ② The assays of the SummarizedExperiment object are stored as a SimpleList containing an expression matrix, where rows represent genes and columns represent patients. ③ The colData of the SummarizedExperiment object is a table(DFrame object of S4), where the row names must be the same as the column names of the expression matrix. The column names of the table represent the clinical information of patients. The detailed information about the column names is presented below. column name Recommend value Description Necessity in tigeR analysis sample id character The sample identification. ✓ patient_name character The patient identification. ✕ dataset_id character The dataset identification. ✕ dataset_group character ✕ Treatment PRE/POST The patient sample is collected after Treatment or before Treatment ✓ response CR/MR/PR/PD/SD/NR/R/N The Immunotherapy response. ✕ response_NR R/N The Immunotherapy response which only contains R or N. ✓ M.stage character The M stage of patients. ✕ overall.survival..days. value The number of days, months or years of survival time of patients.(all samples must be the same unit) ✓ vital.status Alive/Dead The survival status of patient. ✓ Total.Mutation numeric The total mutation gene numbers. ✕ Gender M/F The gender of patient. ✕ Therapy character The anti-tumor therapy on patients. ✕ age_start numeric When the tumor is diagnosed. ✕ tumor_type character The type of tumor. ✕ seq_type character The sequencing type. ✕ id character The identification of dataset. ✕ 1.2 Obtain data from tigeR web server Dataloader(c(1,2,3), use_source=&quot;Web Server&quot;) 1.3 Obtain data from ExperimentHub Dataloader(c(1,2,3), use_source=&quot;ExperimentHub) 1.4 Pre-processing of Custom Data  When importing custom data, you need to prepare at least one expression matrix (rows for genes, columns for samples), along with the corresponding column information table, which should include at least the following information: sample id Treatment (PRE/POST) response_NR (R/N) overall.survival..days. (Missing data is also acceptable) vital.status (Missing data is also acceptable)  Here is a brief example: ## Construt FPKM Matrix genes &lt;- c(&quot;5S_rRNA&quot;, &quot;A1BG&quot;, &quot;A1BG-AS1&quot;) samples &lt;- c(&quot;SRR3184279&quot;, &quot;SRR3184280&quot;, &quot;SRR3184281&quot;) mtr &lt;- matrix( c(0.04115157, 0.01311394, 0.02275499, 0.07774626, 0.29494916, 0.11743900, 2.01782650, 0.83763027, 0.77378394), nrow = 3, ncol = 3, byrow = TRUE, dimnames = list(genes, samples)) ## Construct Clinical Information Table data &lt;- data.frame( sample_id = c(&quot;SRR3184279&quot;, &quot;SRR3184280&quot;, &quot;SRR3184281&quot;), Treatment = c(&quot;PRE&quot;, &quot;PRE&quot;, &quot;PRE&quot;), response_NR = c(&quot;N&quot;, &quot;R&quot;, &quot;R&quot;), overall_survival_days = c(607, 927, 948), vital_status = c(&quot;Dead&quot;, &quot;Alive&quot;, &quot;Alive&quot;), stringsAsFactors = FALSE) ## Construct SummarizedExperiment Object SE &lt;- SummarizedExperiment::SummarizedExperiment( assays = list(fpkm = mtr), colData = data) SE # class: SummarizedExperiment # dim: 3 3 # metadata(0): # assays(1): fpkm # rownames(3): 5S_rRNA A1BG A1BG-AS1 # rowData names(0): # colnames(3): SRR3184279 SRR3184280 SRR3184281 # colData names(5): sample_id Treatment response_NR overall_survival_days # vital_status "],["biomarker-evaluation.html", "Chapter 2  Biomarker Evaluation 2.1 Integrate analysis 2.2 Differential analysis 2.3 Suvival analysis 2.4 Calculate comprehensive signature score 2.5 Assess the Performance of Signature", " Chapter 2  Biomarker Evaluation 2.1 Integrate analysis  The integrate_analysis() function returns the results of both the differential analysis and survival analysis for a gene or gene set within a dataset (or datasets). integrate_analysis(SE=MEL_GSE91061, geneSet=&quot;CD274&quot;) 2.2 Differential analysis  You can use diff_biomk() to visualize differential analysis result between Pre-Treatment and Post-Treatment patients or Responders and Non-Responders in specified gene. Pre-Treatment vs Post-Treatment diff_biomk(SE=MEL_GSE91061,gene=&#39;CD274&#39;,type=&#39;Treatment&#39;) + ggtitle(&quot;Pre-Treatment vs Post-Treatment) + theme(plot.title = element_text(hjust = 0.5)) Responder vs Non-Responder diff_biomk(SE=MEL_GSE91061,gene=&#39;CD274&#39;,type=&#39;Response&#39;) + ggtitle(&quot;Responder vs Non-Responder&quot;) + theme(plot.title = element_text(hjust = 0.5)) 2.3 Suvival analysis  You can use diff_biomk() to visualize survival analysis result in specified gene. P &lt;- surv_biomk(SE=MEL_GSE91061,gene=&#39;CD274&#39;) P$plot &lt;- P$plot + ggtitle(&quot;Survival analysis&quot;) + theme(plot.title = element_text(hjust = 0.5)) P 2.4 Calculate comprehensive signature score  By employing the score_biomk() function, you can obtain a comprehensive signature score matrix for the 23 signatures in TigeR. In this matrix, the columns represent the signature scores, and the rows denote the sample names. Signature Method PMID IRS multivariate Cox analysis 35280438 tGE8 median of Z-score 31686036 MEMTS Average mean 35769483 PRGScore Average mean 35479097 Angiogenesis Average mean 29867230 Teffector Average mean 29867230 Myeloid_inflammatory Average mean 29867230 IFNG_Sig Average mean 29150430 TLS Weighted mean 31942071 MSKCC Weighted mean 34421886 LMRGPI Weighted mean 35582412 PRS Weighted mean 35085103 Stemnesssignatures Weighted mean 35681225 GRIP Weighted mean 35492358 IPS Weighted mean 32572951 Tcell_inflamed_GEP Weighted mean 30309915 DDR Z-score;PCA 29443960 CD8Teffector Z-score;PCA 29443960 CellCycleReg Z-score;PCA 29443960 PanFTBRs Z-score;PCA 29443960 EMT1 Z-score;PCA 29443960 EMT2 Z-score;PCA 29443960 EMT3 Z-score;PCA 29443960 sig_res &lt;- score_biomk(MEL_GSE78220)  Columns represent signatures and rows represent sample. 2.5 Assess the Performance of Signature  By employing the roc_biomk() function, you can assess the performance of built-in and custom signatures in different datasets.  The function will generate a roc object and a curve to assess the predictive performance. sig_roc &lt;- roc_biomk(MEL_PRJEB23709, Weighted_mean_Sigs$Tcell_inflamed_GEP, method = &quot;Weighted_mean&quot;, rmBE=TRUE, response_NR=TRUE) "],["tumor-microenviroment-analysis.html", "Chapter 3  Tumor Microenviroment Analysis 3.1 Availiable TME Analysis Method in tigeR 3.2 Derive the Proportions of Different TME Cell Types 3.3 Visualization and Comparing the Cell Proportions 3.4 Searching for Key Cell Types Influencing Immune Therapy Response  More Details about TME Analysis", " Chapter 3  Tumor Microenviroment Analysis 3.1 Availiable TME Analysis Method in tigeR Algorithm license PMID TIMER free (GPL 2.0) 27549193 CIBERSORT free for non-commercial use only 25822800 MCPCounter free (GPL 3.0) 27765066 xCell free (GPL 3.0) 29141660 IPS free (BSD) 28052254 EPIC free for non-commercial use only (Academic License) 29130882 ESTIMATE free (GPL 2.0) 24113773 ABIS free (GPL 2.0) 30726743 ConsensusTME free (GPL 3.0) 31641033 quanTIseq free (BSD) 31126321 3.2 Derive the Proportions of Different TME Cell Types  You can use the function deconv_TME() to derive the proportions of different tumor microenvironment cell types from gene expression data with these tools. devtools::install_github(&#39;dviraran/xCell&#39;) devtools::install_github(&quot;GfellerLab/EPIC&quot;) devtools::install_github(&quot;cansysbio/ConsensusTME&quot;) devtools::install_github(&quot;federicomarini/quantiseqr&quot;) ## TIMER frac1 &lt;- deconv_TME(MEL_GSE78220,method=&quot;TIMER&quot;) ## CIBERSORT frac2 &lt;- deconv_TME(MEL_GSE78220,method=&quot;CIBERSORT&quot;) ## MCPCounter frac3 &lt;- deconv_TME(MEL_GSE78220,method=&quot;MCPCounter&quot;) ## xCell frac4 &lt;- deconv_TME(MEL_GSE78220,method=&quot;xCell&quot;) ## IPS frac5 &lt;- deconv_TME(MEL_GSE78220,method=&quot;IPS&quot;) ## EPIC frac6 &lt;- deconv_TME(MEL_GSE78220,method=&quot;epic&quot;) ## ESTIMATE frac7 &lt;- deconv_TME(MEL_GSE78220,method=&quot;ESTIMATE&quot;) ## ABIS frac8 &lt;- deconv_TME(MEL_GSE78220,method=&quot;ABIS&quot;) ## ConsensusTME frac9 &lt;- deconv_TME(MEL_GSE78220,method=&quot;ConsensusTME&quot;) ## quanTIseq frac10 &lt;- deconv_TME(MEL_GSE78220,method=&quot;quanTIseq&quot;) 3.3 Visualization and Comparing the Cell Proportions cell1 &lt;- c(&quot;T cells CD4&quot;,&quot;Neutrophil&quot;, &quot;Macrophage&quot;,&quot;mDCs&quot;,&quot;B cells&quot;, &quot;T cells CD8&quot;) pie1 &lt;- fraction_pie(cell_name_filter(frac1),feature=factor(cell1, levels = cell1)) cell2 &lt;- c(&quot;DCs resting&quot;, &quot;T cells CD8&quot;, &quot;T cells CD4 naive&quot;, &quot;Macrophages M2&quot;, &quot;Yd T cells&quot;, &quot;Monocytes&quot;,&quot;Mast cells resting&quot;, &quot;Neutrophils&quot;, &quot;Tregs&quot;,&quot;B cells naive&quot;) pie2 &lt;- fraction_pie(cell_name_filter(frac2[[1]][1:22,]),feature=factor(cell2, levels = cell2)) 3.4 Searching for Key Cell Types Influencing Immune Therapy Response ## TIMER TM &lt;- deconv_TME(MEL_GSE91061,method = &quot;TIMER&quot;) TM_SE &lt;- SummarizedExperiment(assays=SimpleList(TM), colData=colData(MEL_GSE91061)) browse_biomk(SE=TM_SE)  More Details about TME Analysis  TIMER is a comprehensive tool for systematical analysis of immune infiltrates across diverse cancer types.  CIBERSORT is an analytical tool from the Alizadeh Lab and Newman Lab to impute gene expression profiles and provide an estimation of the abundances of member cell types in a mixed cell population, using gene expression data.  xCell is a gene signatures-based method learned from thousands of pure cell types from various sources. xCell applies a novel technique for reducing associations between closely related cell types.  ConsensusTME a consensus approach to generating cancer specific signatures for multiple cell types found within the tumour microenvironment. "],["prediction-model-construction.html", "Chapter 4  Prediction Model Construction 4.1 Build Model 4.2 Test Model", " Chapter 4  Prediction Model Construction 4.1 Build Model  You can use function build_Model to build machine learning predictive model including naive Bayes models, Support vector machine model, random forest model, Cancerclass model, Adaboost model, Logitboost model, Logistics regression model.  The function returns a trained model. train_set &lt;- list(MEL_GSE91061, MEL_phs000452, RCC_Braun_2020) mymodel &lt;- build_Model(Model=&#39;NB&#39;, SE=train_set, feature_genes=Stem.Sig, response_NR = TRUE) 4.2 Test Model  test_Model are designed for testing model built by build_Model function. This function returns a ROC object. test_Model(mymodel,MEL_78220) "],["response-prediction.html", "Chapter 5  Response Prediction", " Chapter 5  Response Prediction pred_response function predict the immunotherapy response for the patients from gene expression data using our pre-trained machine learning models or public gene expression signatures. pred_response(SE=MEL_GSE93157,Signature = ipt, method = &quot;Weighted_mean&quot;,threshold = 0.8, PT_drop = FALSE,sort_by = &quot;Customed.Signature&quot;, group_by = &quot;Customed.Signature&quot;,show.real = TRUE, rankscore = FALSE) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
